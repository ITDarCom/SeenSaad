<template name='article'>
    {{#with thisArticle}}
        <div class='row'>
            <div class='col-md-offset-1 col-md-10'>
                {{#if allowReading}}
                    {{>headerText}}

                    {{seenChange}}
                    <div class='panel panel-info'>
                        <div class='panel-heading'>
                            <div class='row text-center'>
                                <h4>{{title}}</h4>
                                <hr class='title'>
                            </div>
                            <div class='row'>
                                <div class='col-xs-12 col-md-3'>
                                    <span class='glyphicon glyphicon-user' aria-hidden='true'></span><a
                                        href='{{pathFor 'profile' id=this.user}}'>&nbsp;{{userUsername user}}</a>
                                </div>
                                <div class='col-xs-12 col-md-3'>
                                    <span class='glyphicon glyphicon-time'
                                          aria-hidden='true'></span> {{> Time data=createdAt}}
                                </div>
                                <div class='col-xs-12 col-md-3'>
                                    {{#if allowReading}}
                                        <span><i class='fa fa-eye'
                                                 title='{{getArabicMsg "readLabel"}}'></i> {{read}}</span>
                                    {{/if}}
                                    &nbsp; &nbsp;
                                <span><i title='{{ getArabicMsg "contributingLabel"}}' class='fa fa-comments'></i>
                                    {{commentCounter}}</span>
                                </div>
                                <div class='col-md-3 text-left'>
                                    {{#if owner}}
                                        <button class='remove btn-xs btn btn-danger'
                                                title='{{getArabicMsg "deleteButtonTitle"}}'>
                                            <i class='fa fa-trash'></i>
                                        </button>
                                        <button id='editButton' class='edit btn-xs btn{{#if canEdit}} btn-warning
                                        {{else}} btn-default{{/if}}'
                                                title='{{getArabicMsg "editButtonTitle"}}'>
                                            <i class='fa fa-pencil'></i>{{allowedTime}} <span id="editCounter"></span>
                                        </button>
                                    {{/if}}
                                    <button class='favorite btn-xs btn btn-success'
                                            title='{{getArabicMsg "addToFavorites"}}'>
                                        <i class='fa {{#if favorite}}fa-heart-o{{else}}fa-heart{{/if}}'></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class='panel-body'>
                            <div class='textEditor' name='textEditor'>{{{body}}}</div>
                        </div>
                    </div>
                    {{> comments data=this._id}}
                    {{#if allowContributing}}
                        <div class='panel panel-info'>
                            <div class='panel-body'>
                                {{#autoForm id='addCommentForm' name='addCommentForm' type='method'  meteormethod='addComment'
                                schema='commentsSchema'}}
                                    <fieldset>
                                        {{> afQuickField name='commentText' label=false class='commentTextarea'}}
                                        {{> afQuickField name='articleId' type='hidden' label=false value=this._id}}
                                    </fieldset>
                                    <button type='submit' class='btn btn-block btn-primary'>
                                        {{getArabicMsg 'addButtonLabel'}}</button>
                                {{/autoForm}}


                            </div>
                        </div>
                    {{/if}}
                {{/if}}
            </div>
            <!--col-md-10-->
        </div>
        <!--row-->
    {{/with}}
</template>
<template name="comments">
    <!--Comments-->
    {{#each comments}}
        <div class='panel panel-info'>
            <div class='panel-body'>
                <div class='text-muted row'>
                    <div class="{{#if owner}}col-md-4 col-xs-4{{else}}col-md-6 col-xs-4{{/if}}">
                    <span class='glyphicon glyphicon-user'
                          aria-hidden='true'></span> {{userUsername commenter}}
                    </div>
                    <div class="{{#if owner}}col-md-6 col-xs-6{{else}} col-md-6 col-xs-4{{/if}}">  <span
                            class='glyphicon glyphicon-time'
                                                                       aria-hidden='true'></span>
                        {{> Time data=createdAt}} </div>
                    {{#if owner}}
                        <div class="col-md-2 col-xs-2 text-left">
                            <button class="btn btn-xs btn-danger removeComment"><i class="fa fa-trash"></i></button>
                        </div>{{/if}}
                </div>
                <hr>
                <div class='textEditor' name='textEditor'>{{{nl2br commentText}}}</div>
            </div>
        </div>
    {{/each}}
</template>
