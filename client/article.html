<template name='article'>
    {{#with thisArticle}}
        <div class='row'>
            <div class='col-md-offset-1 col-md-10'>
                {{#if allowReading}}
                    {{>headerText}}
                    {{seenChange}}
                    <div class='panel panel-info'>
                        <div class='panel-heading'>
                            <div class='row text-center'>
                                <h4>{{title}}</h4>
                                <hr class='title'>
                            </div>
                            <div class='row'>
                                <div class='col-xs-12 col-md-3'>
                                    <span class='glyphicon glyphicon-user' aria-hidden='true'></span><a
                                        href='{{pathFor 'profile' id=this.user}}'>&nbsp;{{username}}</a>
                                </div>
                                <div class='col-xs-12 col-md-3'>
                                    <span class='glyphicon glyphicon-time'
                                          aria-hidden='true'></span> {{> Time data=generalDate}}
                                </div>
                                <div class='col-xs-12 col-md-3'>
                                    {{#if allowReading}}
                                        <span><i class='fa fa-eye'
                                                 title='{{getArabicMsg "readLabel"}}'></i> {{read}}</span>
                                    {{/if}}
                                    &nbsp; &nbsp;
                                <span><i title='{{ getArabicMsg "contributingLabel"}}' class='fa fa-comments'></i>
                                    {{commentsCounter}}</span>
                                </div>
                                {{#unless isDeleted}}
                                <div class='col-md-3 text-left'>
                                    {{#if owner}}
                                        <button class='remove btn-xs btn btn-danger'
                                                title='{{getArabicMsg "deleteButtonTitle"}}'>
                                            <i class='fa fa-trash'></i>
                                        </button>
                                        <button id='editButton' class='edit btn-xs btn btn-warning btn-default'
                                                title='{{getArabicMsg "editButtonTitle"}}'>
                                            <i class='fa fa-pencil'></i>{{allowedTime}} <span id="editCounter"></span>
                                        </button>
                                    {{/if}}
                                    <button class='favorite btn-xs btn btn-success'
                                            title='{{getArabicMsg "addToFavorites"}}'>
                                        <i class='fa {{#if favorite}}fa-heart-o{{else}}fa-heart{{/if}}'></i>
                                    </button>
                                </div>
                                {{/unless}}
                            </div>

                        </div>
                        <div class='panel-body'>
                            {{{bodyText}}}
                            <br>

                            <div class="pull-left">{{>Time data=this.createdAt}}</div>
                            <hr>
                            {{> additions data=_id }}
                        </div>
                    </div>
                    {{> comments data=this._id}}
                    {{#if allowContributing}}
                        <div class='panel panel-info'>
                            <div class='panel-body'>
                                {{#autoForm id='addCommentForm' name='addCommentForm' type='method'  meteormethod='addComment'
                                schema='commentsSchema'}}
                                    <fieldset>
                                        {{> afQuickField name='commentText' label=false class='commentTextarea'}}
                                        {{> afQuickField name='articleId' type='hidden' label=false value=this._id}}
                                    </fieldset>
                                    <button type='submit' class='btn btn-block btn-primary'>
                                        {{getArabicMsg 'addButtonLabel'}}</button>
                                {{/autoForm}}
                            </div>
                        </div>
                    {{/if}}
                {{/if}}
            </div>
            <!--col-md-10-->
        </div>
        <!--row-->
    {{/with}}
</template>
<template name="comments">
    <!--Comments-->
    {{#each comments}}
        <div class='panel panel-info'>
            <div class='panel-body'>
                <div class='text-muted'>
                    <div class="row">
                    <div class="col-md-12 col-xs-12">
                    <span class='glyphicon glyphicon-user'
                          aria-hidden='true'></span> {{commenterUsername}}
                    </div>
                    </div>
                    <div class="row">
                    <div class=" col-md-6 col-xs-6" style=" white-space: nowrap; text-overflow: ellipsis;">  <span
                            class='glyphicon glyphicon-time'
                            aria-hidden='true'></span>
                        {{> Time data=createdAt}} </div>
                    <div class="col-md-6 col-xs-6 text-left" style="padding-left:10px !important;">
                        {{#if articleOwner}}
                            <button class="btn btn-xs btn-danger removeComment"><i class="fa fa-trash"></i></button>
                        {{/if}}
                        {{#if canEdit}}
                            {{#unless articleOwner}}
                                <button class="btn btn-xs btn-danger removeComment"><i class="fa fa-trash"></i></button>
                            {{/unless}}
                            <button class="btn btn-xs btn-warning updateComment"><i class="fa fa-pencil"></i></button>

                        {{/if}}
                        </div>
                    </div>
                </div>
                <hr>
                <div class="commentText">
                    {{{nl2br commentText}}}</div>
            </div>
        </div>
    {{/each}}
</template>

<template name="additions">
    {{#each additions data}}
        <div class="addition">{{{text}}}
            <br>

            <div class="pull-left">{{#if owner}}
                <button class='removeAddition btn-xs btn btn-danger' title='{{getArabicMsg "deleteButtonTitle"}}'>
                    <i class='fa fa-trash'></i>
                </button>{{/if}}
                {{>Time data=createdAt}}</div>
            <hr>
        </div>

    {{/each}}
</template>