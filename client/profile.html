<!--suppress ALL -->
<template name="profile">
    {{#with thisUser}}
        <div class="row profile">
            {{#if notUserOrGuest}}
                <div class="col-md-3">
                    <div class="profile-userpic">
                        <img src="{{getProfilePic currentId}}"
                             class="img-responsive" alt="">
                    </div>
                    <br>
                    <div class="row profile-userbuttons">
                        <button type="button" class="btn btn-primary btn-sm col-xs-offset-2 col-xs-8"
                                id="sendMessage"><span class="glyphicon glyphicon-envelope"></span>
                            &nbsp;{{getArabicMsg "privateMessage"}}
                        </button>
                    </div>
                    <div class="text-center">
                        <h3> {{> userInformation}}</h3>
                    </div>
                </div>
            {{/if}}
            <div class="{{#if notUserOrGuest}}col-md-9{{else}}col-md-12{{/if}}">
                <div class="row">
                    {{ removeAlert}}                    
                    {{> Template.dynamic template=active}}
                </div>
            </div>
        </div>
    {{/with}}
</template>
<template name="profileSetting">
    {{#if isMe}}
        <div class="row">
            <div class="col-md-offset-1 col-md-10">
                {{> headerText}}
                <div class="panel with-nav-tabs  panel-info">
                    <div class="panel-heading">
                        <ul class="nav nav-tabs nav-justified">
                            <li role="presentation" class="{{active 'profileImg'}}">
                                <a id="profileImg" class="profileSettingBtn" href="{{pathFor 'editProfileImg'}}">
                                {{getArabicMsg "image"}}</a>
                            </li>
                            <li role="presentation" class="{{active 'personalInformation' }}">
                                <a id="personalInformation" class="profileSettingBtn"
                                    href="{{pathFor 'editPersonalInfo'}}">{{getArabicMsg "personalInformation"}}</a>
                            </li>
                            <li role="presentation" class="{{active 'chgpasswd'}}">
                                <a id="chgpasswd" class="profileSettingBtn" 
                                href="{{pathFor 'resetPasswd'}}">
                                {{getArabicMsg "password"}}</a></li>
                        </ul>
                    </div>
                    <div class="panel-body">
                        {{> Template.dynamic template=activeSetting}}
                    </div>
                </div>
            </div>
        </div>
    {{/if}}
</template>
<template name="profileImg">
    <br>
    <div class="row">
        <div class="col-md-offset-2 col-md-7">

            <div class="profile-userpic">
                <img src="{{getProfilePic}}"
                     class="img-responsive" alt="">
            </div>
            {{#if isUploading}}
                {{> spinner}}
            {{/if}}
            <div class="input-group image-preview">
                <input type="text" class="form-control image-preview-filename" disabled="disabled">
                <!-- don't give a name === doesn't send on POST/GET -->
                <span class="input-group-btn">
                    <!-- image-preview-clear button -->
                    <button type="button" class="btn btn-default image-preview-clear" style="display:none;">
                        <span class="glyphicon glyphicon-remove"></span> Clear
                    </button>
                    <!-- image-preview-input -->
                    <div class="btn btn-default image-preview-input
                        {{#if isUploading}}disabled{{/if}}">
                        <span class="glyphicon glyphicon-folder-open"></span>
                        <span class="image-preview-input-title">{{getArabicMsg 'browse'}}</span>
                        <input 
                            disabled="{{#if isUploading}}true{{/if}}"
                            id="profile-image-input"
                            type="file" 
                            accept="image/png, image/jpeg, image/gif" 
                            name="input-file-preview"/>
                        <!-- rename it -->
                    </div>
                </span>
            </div>


        </div>
    </div>


</template>
<template name="chgpasswd">
    <div class="col-md-offset-2 col-md-8"> {{> atForm state="changePwd"}}</div>
</template>
<template name="personalInformation">
    <br>

    <div class="row">
        <div class="col-md-offset-2 col-md-8">
            <div class="alert alert-danger" hidden id="alerter"><a class="close" data-dismiss="alert">Ã—</a></div>
            {{#autoForm schema='personalInformationSchema'  doc=thisUser collection='Meteor.users' resetOnSuccess=false
            id="updatePersonalInformation" type="update"}}
                <div class="row">
                    <div class="col-md-8">{{> afQuickField name="username" label=false  placeholder=(getArabicMsg
                    "usernamePlaceholder") class="input-group" }}</div>
                </div>
                <div class="row">
                    <div class="col-md-8 col-xs-8">{{> afQuickField name="fullName.name"  label=false placeholder=
                    (getArabicMsg "fullNamePlaceholder")}}  </div>
                    <div class="col-md-4 col-xs-4">{{> afQuickField name="fullName.permission" }}  </div>
                </div>
                <div class="row">

                    <div class="col-md-8 col-xs-8">
                        <div class="form-group well well-sm">{{> afQuickField name="gender.value"  label=false}}</div>
                    </div>
                    <div class="col-md-4 col-xs-4">{{> afQuickField name="gender.permission"   }} </div>
                </div>
                <div class="row">
                    <div class="col-md-8 col-xs-8">{{> afQuickField name="birthday.date" id="birthday" type="text"
                    readonly=true value=birthdayformat label=false
                    placeholder=(getArabicMsg "birthdayPlaceholder")}}  </div>
                    <div class="col-md-4 col-xs-4">{{> afQuickField name="birthday.permission"    }} </div>
                </div>
                <div class="row">
                    <div class="col-md-8 col-xs-8">{{> afQuickField name="email.address"   label=false
                    placeholder= (getArabicMsg "emailPlaceholder")}}  </div>
                    <div class="col-md-4 col-xs-4">{{> afQuickField name="email.permission"   }} </div>
                </div>
                <div class="row">
                    <div class="col-md-8 col-xs-8">{{> afQuickField name="mobile.number"  label=false
                    placeholder = (getArabicMsg "mobilePlaceholder")}}  </div>
                    <div class="col-md-4 col-xs-4">{{> afQuickField name="mobile.permission"  }} </div>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary col-md-8">{{getArabicMsg 'saveButton'}}</button>
                </div>
            {{/autoForm}}
        </div>
    </div>

</template>
<template name="userInformation">
    {{#with thisUser}}
        {{#each properties}}
            <h5>{{label}} {{{value}}}</h5>
        {{/each}}
    {{/with}}
</template>
